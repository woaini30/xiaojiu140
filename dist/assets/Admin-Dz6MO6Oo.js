import{r as O,A as P,c as y,a as u,b as l,w as a,f as r,u as _,v as R,g as m,e as j,B as I,C as T,E as V,D as d,p as v}from"./index-Dku3J1xH.js";import{r as f}from"./request-C4SRpGQ-.js";const F={class:"card",style:{"margin-bottom":"5px"}},G={class:"card",style:{"margin-bottom":"5px"}},H={class:"card",style:{"margin-bottom":"5px"}},K=["src"],L={style:{"margin-top":"10px"}},Q={class:"dialog-footer"},Z={__name:"Admin",setup(W){const e=O({name:null,tableData:[],pageNum:1,pageSize:5,total:0,formVisible:!1,form:{},ids:[],rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}]}}),b=P(),C=o=>{console.log(o.data),e.form.avatar=o.data},s=()=>{f.get("/admin/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(o=>{console.log(o),e.tableData=o.data.list,e.total=o.data.total})};s();const x=()=>{e.name=null,s()},k=()=>{e.formVisible=!0,e.form={}},h=()=>{b.value.validate(o=>{o&&(e.form.id?S():w())})},w=()=>{f.post("/admin/add",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,d.success("新增成功"),s()):d.error(o.msg)})},S=o=>{f.put("/admin/update",e.form).then(t=>{t.code==="200"?(e.formVisible=!1,d.success("更新成功"),s()):d.error(t.msg)})},z=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},N=o=>{V.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{f.delete("/admin/deleteById/"+o).then(t=>{t.code==="200"?(d.success("单个删除成功"),s()):d.error(t.msg)})}).catch()},B=o=>{console.log(o),e.ids=o.map(t=>t.id),console.log(e.ids)},U=()=>{if(e.ids.length===0){d.warning("请选择数据");return}V.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{f.delete("/admin/deleteBatch",{data:e.ids}).then(o=>{o.code==="200"?(d.success("批量删除成功"),s()):d.error(o.msg)})}).catch()};return(o,t)=>{const A=r("el-icon"),c=r("el-input"),i=r("el-button"),p=r("el-table-column"),D=r("el-table"),E=r("el-pagination"),g=r("el-form-item"),q=r("el-upload"),$=r("el-form"),J=r("el-dialog");return v(),y("div",null,[u("div",F,[l(c,{style:{width:"240px","margin-right":"10px"},modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=n=>e.name=n),placeholder:"请输入姓名查询"},{prefix:a(()=>[l(A,null,{default:a(()=>[l(_(R))]),_:1})]),_:1},8,["modelValue"]),l(i,{type:"primary",onClick:s},{default:a(()=>[...t[7]||(t[7]=[m("查 询",-1)])]),_:1}),l(i,{type:"warning",onClick:x},{default:a(()=>[...t[8]||(t[8]=[m("重 置",-1)])]),_:1})]),u("div",G,[l(i,{type:"primary",onClick:k},{default:a(()=>[...t[9]||(t[9]=[m("新 增",-1)])]),_:1}),l(i,{type:"danger",onClick:U},{default:a(()=>[...t[10]||(t[10]=[m("批量删除",-1)])]),_:1})]),u("div",H,[l(D,{data:e.tableData,stripe:"",onSelectionChange:B},{default:a(()=>[l(p,{type:"selection",width:"55"}),l(p,{label:"账号",prop:"username"}),l(p,{label:"姓名",prop:"name"}),l(p,{label:"头像"},{default:a(n=>[n.row.avatar?(v(),y("img",{key:0,src:n.row.avatar,alt:"",style:{display:"block",width:"40px",height:"40px","border-radius":"50%"}},null,8,K)):j("",!0)]),_:1}),l(p,{label:"操作"},{default:a(n=>[l(i,{onClick:M=>z(n.row),type:"primary",icon:_(I),circle:""},null,8,["onClick","icon"]),l(i,{onClick:M=>N(n.row.id),type:"primary",icon:_(T),circle:"",color:"red"},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"]),u("div",L,[l(E,{onSizeChange:s,onCurrentChange:s,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=n=>e.pageNum=n),"page-size":e.pageSize,"onUpdate:pageSize":t[2]||(t[2]=n=>e.pageSize=n),"page-sizes":[5,10,15,20],background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","total"])])]),l(J,{title:"管理员信息",modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=n=>e.formVisible=n),width:"500","destroy-on-close":""},{footer:a(()=>[u("div",Q,[l(i,{onClick:t[5]||(t[5]=n=>e.formVisible=!1)},{default:a(()=>[...t[12]||(t[12]=[m("取消",-1)])]),_:1}),l(i,{type:"primary",onClick:h},{default:a(()=>[...t[13]||(t[13]=[m("保存",-1)])]),_:1})])]),default:a(()=>[l($,{ref_key:"formRef",ref:b,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"50px","padding-top":"10px"}},{default:a(()=>[l(g,{label:"账号",prop:"username"},{default:a(()=>[l(c,{modelValue:e.form.username,"onUpdate:modelValue":t[3]||(t[3]=n=>e.form.username=n),autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),l(g,{label:"头像"},{default:a(()=>[l(q,{class:"avatar-uploader",action:"http://localhost:8081/files/upload","list-type":"picture","on-success":C},{default:a(()=>[l(i,{type:"primary"},{default:a(()=>[...t[11]||(t[11]=[m("上传头像",-1)])]),_:1})]),_:1})]),_:1}),l(g,{label:"姓名",prop:"name"},{default:a(()=>[l(c,{modelValue:e.form.name,"onUpdate:modelValue":t[4]||(t[4]=n=>e.form.name=n),autocomplete:"off",placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{Z as default};
