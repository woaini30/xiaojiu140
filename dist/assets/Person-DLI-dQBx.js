import{r as p}from"./request-C4SRpGQ-.js";import{_ as w,A as N,r as B,c as f,b as o,w as a,a as _,e as I,f as s,d as q,u as C,G as T,g as J,D as d,p as u}from"./index-Dku3J1xH.js";const O={class:"card",style:{width:"40%",padding:"20px 50px","background-color":"#ffffff","place-self":"center"}},A={style:{width:"110%",display:"flex","justify-content":"center","margin-bottom":"20px"}},E=["src"],P={key:0},R={style:{"text-align":"center"}},j={__name:"Person",emits:["updateUser"],setup(D,{emit:g}){const b=N(),e=B({user:JSON.parse(localStorage.getItem("demo-user")),form:{},rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],no:[{required:!0,message:"请输入姓名",trigger:"blur"}]}}),V=l=>{console.log(l.data),e.form.avatar=l.data},i=g;e.user.role==="STU"?p.get("/student/selectById/"+e.user.id).then(l=>{e.form=l.data}):e.form=e.user;const x=()=>{e.user.role==="STU"?p.put("/student/update",e.form).then(l=>{l.code==="200"?(d.success("更新成功"),localStorage.setItem("demo-user",JSON.stringify(e.form)),i("updateUser")):d.error(l.msg)}):p.put("/admin/update",e.form).then(l=>{l.code==="200"?(d.success("更新成功"),localStorage.setItem("demo-user",JSON.stringify(e.form)),i("updateUser")):d.error(l.msg)})};return(l,t)=>{const y=s("el-icon"),v=s("el-upload"),m=s("el-input"),n=s("el-form-item"),c=s("el-radio"),U=s("el-radio-group"),h=s("el-input-number"),S=s("el-button"),k=s("el-form");return u(),f("div",O,[o(k,{ref_key:"formRef",ref:b,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"50px","padding-top":"10px"}},{default:a(()=>[_("div",A,[o(v,{class:"avatar-uploader",action:"http://localhost:8081/files/upload","show-file-list":!1,"on-success":V},{default:a(()=>[e.form.avatar?(u(),f("img",{key:0,src:e.form.avatar,class:"avatar"},null,8,E)):(u(),q(y,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[o(C(T))]),_:1}))]),_:1})]),o(n,{label:"账号",prop:"username"},{default:a(()=>[o(m,{modelValue:e.form.username,"onUpdate:modelValue":t[0]||(t[0]=r=>e.form.username=r),autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),o(n,{label:"姓名",prop:"name"},{default:a(()=>[o(m,{disabled:"",modelValue:e.form.name,"onUpdate:modelValue":t[1]||(t[1]=r=>e.form.name=r),autocomplete:"off",placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),e.user.role==="STU"?(u(),f("div",P,[o(n,{label:"性别"},{default:a(()=>[o(U,{modelValue:e.form.sex,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.sex=r)},{default:a(()=>[o(c,{value:"男",label:"男"}),o(c,{value:"女",label:"女"})]),_:1},8,["modelValue"])]),_:1}),o(n,{label:"学号",prop:"no"},{default:a(()=>[o(m,{disabled:"",modelValue:e.form.no,"onUpdate:modelValue":t[3]||(t[3]=r=>e.form.no=r),autocomplete:"off",placeholder:"请输入学号"},null,8,["modelValue"])]),_:1}),o(n,{label:"年龄"},{default:a(()=>[o(h,{style:{width:"180px"},min:10,modelValue:e.form.age,"onUpdate:modelValue":t[4]||(t[4]=r=>e.form.age=r),autocomplete:"off",placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})])):I("",!0),_("div",R,[o(S,{onClick:x,type:"primary",style:{padding:"20px"}},{default:a(()=>[...t[5]||(t[5]=[J("更新个人信息",-1)])]),_:1})])]),_:1},8,["rules","model"])])}}},z=w(j,[["__scopeId","data-v-042fb6d1"]]);export{z as default};
