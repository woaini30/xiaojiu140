import{r as T,A as G,c as b,a as c,b as o,w as a,f as r,u as y,v as H,g as m,e as K,B as Q,C as W,F as X,y as Y,E as k,D as d,p as _,d as Z}from"./index-Dku3J1xH.js";import{r as f}from"./request-C4SRpGQ-.js";const ee={class:"card",style:{"margin-bottom":"5px","background-color":"rgb(255,255,255)"}},le={class:"card",style:{"margin-bottom":"5px","background-color":"rgba(255,255,255,0.74)"}},oe={class:"card",style:{"margin-bottom":"5px"}},te=["src"],ae={style:{"margin-top":"10px"}},ne={class:"dialog-footer"},ie={__name:"Student",setup(re){const e=T({name:null,tableData:[],pageNum:1,pageSize:5,total:0,no:null,formVisible:!1,form:{},ids:[],majorList:[],rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],no:[{required:!0,message:"请输入学号",trigger:"blur"}]}}),V=G();f.get("/major/selectAll").then(n=>{e.majorList=n.data});const C=()=>{window.open("http://localhost:8081/student/export")},w=n=>{n.code==="200"?(d.success("导入成功"),i()):d.error(n.msg)},i=()=>{f.get("/student/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,no:e.no}}).then(n=>{console.log(),e.tableData=n.data.list,e.total=n.data.total})};i();const S=()=>{e.no=null,i()},h=()=>{e.formVisible=!0,e.form={}},z=()=>{V.value.validate(n=>{n&&(e.form.id?B():N())})},N=()=>{f.post("/student/add",e.form).then(n=>{n.code==="200"?(e.formVisible=!1,d.success("新增成功"),i()):d.error(n.msg)})},U=n=>{console.log(n.data),e.form.avatar=n.data},B=n=>{f.put("/student/update",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,d.success("更新成功"),i()):d.error(l.msg)})},j=n=>{e.form=JSON.parse(JSON.stringify(n)),e.formVisible=!0},D=n=>{k.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{f.delete("/student/deleteById/"+n).then(l=>{l.code==="200"?(d.success("单个删除成功"),i()):d.error(l.msg)})}).catch()},q=n=>{console.log(n),e.ids=n.map(l=>l.id),console.log(e.ids)},A=()=>{if(e.ids.length===0){d.warning("请选择数据");return}k.confirm("删除数据后无法恢复，您确认删除吗？","删除确认",{type:"warning"}).then(()=>{f.delete("/student/deleteBatch",{data:e.ids}).then(n=>{n.code==="200"?(d.success("批量删除成功"),i()):d.error(n.msg)})}).catch()};return(n,l)=>{const E=r("el-icon"),g=r("el-input"),s=r("el-button"),v=r("el-upload"),u=r("el-table-column"),L=r("el-table"),$=r("el-pagination"),p=r("el-form-item"),F=r("el-option"),J=r("el-select"),x=r("el-radio"),M=r("el-radio-group"),O=r("el-input-number"),P=r("el-form"),R=r("el-dialog");return _(),b("div",null,[c("div",ee,[o(g,{style:{width:"240px","margin-right":"10px"},modelValue:e.no,"onUpdate:modelValue":l[0]||(l[0]=t=>e.no=t),placeholder:"请输入学号查询"},{prefix:a(()=>[o(E,null,{default:a(()=>[o(y(H))]),_:1})]),_:1},8,["modelValue"]),o(s,{type:"primary",onClick:i},{default:a(()=>[...l[11]||(l[11]=[m("查 询",-1)])]),_:1}),o(s,{type:"warning",onClick:S},{default:a(()=>[...l[12]||(l[12]=[m("重 置",-1)])]),_:1})]),c("div",le,[o(s,{type:"primary",onClick:h},{default:a(()=>[...l[13]||(l[13]=[m("新 增",-1)])]),_:1}),o(s,{type:"danger",onClick:A},{default:a(()=>[...l[14]||(l[14]=[m("批量删除",-1)])]),_:1}),o(v,{style:{display:"inline-block",margin:"0 20px"},action:"http://localhost:8081/student/import","show-file-list":"false","on-success":w},{default:a(()=>[o(s,{type:"info"},{default:a(()=>[...l[15]||(l[15]=[m("导入",-1)])]),_:1})]),_:1}),o(s,{type:"success",onClick:C},{default:a(()=>[...l[16]||(l[16]=[m("导出",-1)])]),_:1})]),c("div",oe,[o(L,{data:e.tableData,stripe:"",onSelectionChange:q},{default:a(()=>[o(u,{type:"selection",width:"60"}),o(u,{label:"账号",prop:"username"}),o(u,{label:"姓名",prop:"name"}),o(u,{label:"性别",prop:"sex"}),o(u,{label:"学号",prop:"no"}),o(u,{label:"年龄",prop:"age"}),o(u,{label:"专业",prop:"majorin"}),o(u,{label:"头像"},{default:a(t=>[t.row.avatar?(_(),b("img",{key:0,src:t.row.avatar,alt:"",style:{display:"block",width:"40px",height:"40px","border-radius":"50%"}},null,8,te)):K("",!0)]),_:1}),o(u,{label:"操作"},{default:a(t=>[o(s,{onClick:I=>j(t.row),type:"primary",icon:y(Q),circle:""},null,8,["onClick","icon"]),o(s,{onClick:I=>D(t.row.id),type:"primary",icon:y(W),circle:"",color:"red"},null,8,["onClick","icon"])]),_:1})]),_:1},8,["data"]),c("div",ae,[o($,{onSizeChange:i,onCurrentChange:i,"current-page":e.pageNum,"onUpdate:currentPage":l[1]||(l[1]=t=>e.pageNum=t),"page-size":e.pageSize,"onUpdate:pageSize":l[2]||(l[2]=t=>e.pageSize=t),"page-sizes":[5,10,15,20],background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.total},null,8,["current-page","page-size","total"])])]),o(R,{title:"学生信息",modelValue:e.formVisible,"onUpdate:modelValue":l[10]||(l[10]=t=>e.formVisible=t),width:"500","destroy-on-close":""},{footer:a(()=>[c("div",ne,[o(s,{onClick:l[9]||(l[9]=t=>e.formVisible=!1)},{default:a(()=>[...l[18]||(l[18]=[m("取消",-1)])]),_:1}),o(s,{type:"primary",onClick:z},{default:a(()=>[...l[19]||(l[19]=[m("保存",-1)])]),_:1})])]),default:a(()=>[o(P,{ref_key:"formRef",ref:V,rules:e.rules,model:e.form,"label-width":"80px",style:{"padding-right":"50px","padding-top":"10px"}},{default:a(()=>[o(p,{label:"账号",prop:"username"},{default:a(()=>[o(g,{modelValue:e.form.username,"onUpdate:modelValue":l[3]||(l[3]=t=>e.form.username=t),autocomplete:"off",placeholder:"请输入账号"},null,8,["modelValue"])]),_:1}),o(p,{label:"专业"},{default:a(()=>[o(J,{style:{width:"100%"},modelValue:e.form.majorin,"onUpdate:modelValue":l[4]||(l[4]=t=>e.form.majorin=t)},{default:a(()=>[(_(!0),b(X,null,Y(e.majorList,t=>(_(),Z(F,{key:t.id,label:t.name,value:t.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(p,{label:"头像"},{default:a(()=>[o(v,{class:"avatar-uploader",action:"http://localhost:8081/files/upload","list-type":"picture","on-success":U},{default:a(()=>[o(s,{type:"primary"},{default:a(()=>[...l[17]||(l[17]=[m("上传头像",-1)])]),_:1})]),_:1})]),_:1}),o(p,{label:"姓名",prop:"name"},{default:a(()=>[o(g,{disabled:e.form.id,modelValue:e.form.name,"onUpdate:modelValue":l[5]||(l[5]=t=>e.form.name=t),autocomplete:"off",placeholder:"请输入姓名"},null,8,["disabled","modelValue"])]),_:1}),o(p,{label:"性别"},{default:a(()=>[o(M,{modelValue:e.form.sex,"onUpdate:modelValue":l[6]||(l[6]=t=>e.form.sex=t)},{default:a(()=>[o(x,{value:"男",label:"男"}),o(x,{value:"女",label:"女"})]),_:1},8,["modelValue"])]),_:1}),o(p,{label:"学号",prop:"no"},{default:a(()=>[o(g,{disabled:e.form.id,modelValue:e.form.no,"onUpdate:modelValue":l[7]||(l[7]=t=>e.form.no=t),autocomplete:"off",placeholder:"请输入学号"},null,8,["disabled","modelValue"])]),_:1}),o(p,{label:"年龄"},{default:a(()=>[o(O,{style:{width:"180px"},min:10,modelValue:e.form.age,"onUpdate:modelValue":l[8]||(l[8]=t=>e.form.age=t),autocomplete:"off",placeholder:"请输入年龄"},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])])}}};export{ie as default};
